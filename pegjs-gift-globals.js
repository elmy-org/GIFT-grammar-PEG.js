var{isArray:a}=Array;(function(A){"use strict";function b(_,B){function C(){this.constructor=_}C.prototype=B.prototype;_.prototype=new C()}function c(_,B,C,D){this.message=_;this.expected=B;this.found=C;this.location=D;this.name="SyntaxError";Error.captureStackTrace?.(this,c)}b(c,Error);c.buildMessage=(_,B)=>{var C={literal:function(_a){return`"${e(_a.text)}"`},"class":function(_a){var _b="",i;for(i=0;i<_a.parts.length;i++)_b+=a(_a.parts[i])?f(_a.parts[i][0])+"-"+f(_a.parts[i][1]):f(_a.parts[i]);return "["+(_a.inverted?"^":"")+_b+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(_a){return _a.description}};function D(_a){return _a.charCodeAt(0).toString(16).toUpperCase()}function e(s){return s.replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\0/g,'\\0').replace(/\t/g,'\\t').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/[\x00-\x0F]/g,function(_a){return '\\x0'+D(_a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(_a){return '\\x'+D(_a)})}function f(s){return s.replace(/\\/g,'\\\\').replace(/\]/g,'\\]').replace(/\^/g,'\\^').replace(/-/g,'\\-').replace(/\0/g,'\\0').replace(/\t/g,'\\t').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/[\x00-\x0F]/g,function(_a){return '\\x0'+D(_a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(_a){return '\\x'+D(_a)})}function g(_a){return C[_a.type](_a)}function h(_a){var _b=Array(_a.length),i,j;for(i=0;i<_a.length;i++)_b[i]=g(_a[i]);_b.sort();if(_b.length>0){for((i=1,j=1);i<_b.length;i++)_b[i-1]!==_b[i]&&(_b[j]=_b[i],j++);_b.length=j}switch(_b.length) {case 1:return _b[0];case 2:return _b[0]+" or "+_b[1];default:return _b.slice(0,-1).join(", ")+", or "+_b[_b.length-1]}}function i(_a){return _a?`"${e(_a)}"`:"end of input"}return "Expected "+h(_)+" but "+i(B)+" found."};function d(_,B){B=B!==void 0?B:{};var C={},D={GIFTQuestions:fY},f=function(_a){return _a},g=fT("Category"),h="$",i=fP("$",!1),j="CATEGORY:",k=fP("CATEGORY:",!1),l=function(_a){return{type:"Category",title:_a}},m=fT("Description"),n=function(_a,_b){var _c={id:iE,tags:iF,type:"Description",title:_a,stem:_b,hasEmbeddedAnswers:!1};iP();iE=null;iF=null;return _c},o="{",p=fP("{",!1),q="}",r=fP("}",!1),s=function(_a,_b,_c,_d){var E=(_d!==null),F=_b?(_b.text+(E?" ":"")):"",G=_b?.format||_d?.format||"moodle",H=F+(E?"_____ "+_d.text:""),I={type:_c.type,title:_a,stem:{format:G,text:H},hasEmbeddedAnswers:E};I=iK(I,_c);iP();return I},t=fT("{= match1 -> Match1\n...}"),u=function(_a,_b){return{type:"Matching",matchPairs:_a,globalFeedback:_b}},v=fT("matches"),w=function(_a){return _a},x=fT("match"),y="=",z=fP("=",!1),aA="->",aB=fP("->",!1),aC=function(_a,_b){var _c={subquestion:{format:(_a!==null?_a.format:iO()),text:(_a!==null?_a.text:"")},subanswer:_b};return _c},aD=fT("{T} or {F} or {TRUE} or {FALSE}"),aE=function(_a,_b,_c){return{type:"TF",isTrue:_a,feedback:_b,globalFeedback:_c}},aF=function(_a){return _a},aG="TRUE",aH=fP("TRUE",!1),aI="T",aJ=fP("T",!1),aK=function(){return!0},aL="FALSE",aM=fP("FALSE",!1),aN="F",aO=fP("F",!1),aP=function(){return!1},aQ=fT("{=correct choice ~incorrect choice ... }"),aR=function(_a,_b){return{type:"MC",choices:_a,globalFeedback:_b}},aS=fT("Choices"),aT=function(_a){return _a},aU=fT("Choice"),aV=/^[=~]/,aW=fQ(["=","~"],!1,!1),aX=function(_a,_b){var _c=_a[2],_d=_a[4],_a={isCorrect:(_a[0]=='='),weight:_c,text:_d,feedback:_b};return _a},aY=fT("(weight)"),aZ="%",bA=fP("%",!1),bB=function(_a){return _a},bC=fT("(percent)"),bD=fR(),bE=function(_a){let _b='a value between -100 and 100';console.log(_a.length);!_a.length&&fO(`${_b} (did you forget to put a value?)`);var _c=parseFloat(_a.map(innerArray=>innerArray[1]).join(""));console.log(_c);if(_c>=-100&&_c<=100)return _c;fO(_b)},bF=fT("(feedback)"),bG="#",bH=fP("#",!1),bI="###",bJ=fP("###",!1),bK=function(_a){return _a},bL=fT("Essay question { ... }"),bM="",bN=function(_a){return{type:"Essay",globalFeedback:_a}},bO=fT("Single short answer { ... }"),bP=function(_a,_b,_c){var _d=[];_d.push({isCorrect:!0,text:_a,feedback:_b,weight:null});return{type:"Short",choices:_d,globalFeedback:_c}},bQ=fT("{#... }"),bR=function(_a,_b){return{type:"Numerical",choices:_a,globalFeedback:_b}},bS=fT("Numerical Answers"),bT=fT("Multiple Numerical Choices"),bU=fT("Numerical Choice"),bV=function(_a,_b){var _c=_a[0],_d=_a[1],E=_a[2],_a={isCorrect:(_c=='='),weight:_d,text:(E!==null?E:{format:iO(),text:'*'}),feedback:_b};return _a},bW=fT("Single numeric answer"),bX=fT("(number with range)"),bY=":",bZ=fP(":",!1),cA=function(_a,_b){return{type:'range',number:_a,range:_b}},cB=fT("(number with high-low)"),cC="..",cD=fP("..",!1),cE=function(_a,_b){return{type:'high-low',numberHigh:_b,numberLow:_a}},cF=fT("(number answer)"),cG=function(_a){return{type:'simple',number:_a}},cH=fT(":: Title ::"),cI="::",cJ=fP("::",!1),cK=function(_a){return iJ(_a.join(''))},cL=fT("Question stem"),cM=function(_a){iN(_a.format);return _a},cN=fT("(blank lines separator)"),cO=fT("(blank lines)"),cP=fT("blank line"),cQ=fT("(Title text)"),cR=function(t){return t},cS=fT("(text character)"),cT=fT("format"),cU="[",cV=fP("[",!1),cW="html",cX=fP("html",!1),cY="markdown",cZ=fP("markdown",!1),dA="plain",dB=fP("plain",!1),dC="moodle",dD=fP("moodle",!1),dE="]",dF=fP("]",!1),dG=function(_a){return _a},dH=fT("(escape character)"),dI="\\",dJ=fP("\\",!1),dK=fT("escape sequence"),dL="~",dM=fP("~",!1),dN="n",dO=fP("n",!1),dP=function(_a){return iI[`\${_a}`]},dQ=fT(""),dR=function(){return fN()},dS=fT("(formatted text excluding '->')"),dT=function(_a,_b){return iQ(_a,_b)},dU=fT("(formatted text)"),dV=fT("(unformatted text)"),dW=function(_a){return iM(_a.join('').trim())},dX=fT("(category text)"),dY=function(_a){return _a.flat().join('')},dZ=function(){return parseFloat(fN())},eA=".",eB=fP(".",!1),eC=/^\d/,eD=fQ([["0","9"]],!1,!1),eE=/^[+\-]/,eF=fQ(["+","-"],!1,!1),eG="####",eH=fP("####",!1),eI=function(_a){return _a},eJ=fT("(single line whitespace)"),eK=fT("(multiple line whitespace)"),eL=" ",eM=fP(" ",!1),eN=function(){iE=null;iF=null},eO=fT("(comment)"),eP="//",eQ=fP("//",!1),eR=/^[^\n\r]/,eS=fQ(["\n","\r"],!0,!1),eT=function(){return null},eU=function(p){var _b=p.join(""),_c=_b.match(/\[id:([^\x00-\x1F\x7F]+?)]/);_c&&(iE=_c[1].trim().replace('\\]',']'));Array.from(_b.matchAll(/\[tag:([^\x00-\x1F\x7F]+?)]/g),function(m){return m[1]}).forEach(_a=>{!iF&&(iF=[]);iF.push(_a)});return null},eV=fT("(space)"),eW="\t",eX=fP("\t",!1),eY=fT("(end of line)"),eZ="\r\n",fA=fP("\r\n",!1),fB="\n",fC=fP("\n",!1),fD="\r",fE=fP("\r",!1),fF=function(){return"EOF"},fG=0,fH=0,fI=[{line:1,column:1}],fJ=0,fK=[],fL=0,fM;if("startRule" in B){if(!(B.startRule in D))throw Error("Can't start parsing from rule \""+B.startRule+"\".");e=D[B.startRule]}function fN(){return _.substring(fH,fG)}function fO(_a,_b){_b=_b!==void 0?_b:fV(fH,fG);throw fX([fT(_a)],_.substring(fH,fG),_b)}function fP(_a,_b){return{type:"literal",text:_a,ignoreCase:_b}}function fQ(_a,_b,_c){return{type:"class",parts:_a,inverted:_b,ignoreCase:_c}}function fR(){return{type:"any"}}function fS(){return{type:"end"}}function fT(_a){return{type:"other",description:_a}}function fU(_a){var _b=fI[_a],p;if(_b)return _b;p=_a-1;while (!fI[p])p--;_b=fI[p];_b={line:_b.line,column:_b.column};while (p<_a) {_.charCodeAt(p)==10?(_b.line++,_b.column=1):(_b.column++);p++}fI[_a]=_b;return _b}function fV(_a,_b){var _c=fU(_a),_d=fU(_b);return{start:{offset:_a,line:_c.line,column:_c.column},end:{offset:_b,line:_d.line,column:_d.column}}}function fW(_a){if(fG<fJ)return;fG>fJ&&(fJ=fG,fK=[]);fK.push(_a)}function fX(_a,_b,_c){return new c(c.buildMessage(_a,_b), _a, _b, _c)}function fY(){var _a,_b,_c,_d;_a=fG;_b=[];_c=fZ();_c==C&&(_c=gA(),_c==C&&(_c=gB()));if(_c!==C)while (_c!==C) {_b.push(_c);_c=fZ();_c==C&&(_c=gA(),_c==C&&(_c=gB()))}else _b=C;_b!==C?(_c=hW(),_c!==C?(_d=hX(),_d!==C?(fH=_a,_b=f(_b),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);return _a}function fZ(){var _a,_b,_c,_d,E,F,G,H;fL++;_a=fG;_b=hY();if(_b!==C){_c=hX();if(_c!==C){_.charCodeAt(fG)==36?(_d=h,fG++):(_d=C,!fL&&fW(i));if(_d!==C){_.substr(fG,9)==j?(E=j,fG+=9):(E=C,!fL&&fW(k));E!==C?(F=hW(),F!==C?(G=hQ(),G!==C?(H=hB(),H!==C?(fH=_a,_b=l(G),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(g));return _a}function gA(){var _a,_b,_c,_d,E,F,G,H;fL++;_a=fG;_b=hY();if(_b!==C){_c=hX();if(_c!==C){_d=[];E=iA();while (E!==C) {_d.push(E);E=iA()}if(_d!==C){E=gZ();E==C&&(E=null);E!==C?(F=hW(),F!==C?(G=hA(),G!==C?(H=hB(),H!==C?(fH=_a,_b=n(E,G),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(m));return _a}function gB(){var _a,_b,_c,_d,E,F,G,H,I,J,K,L,M,N,O,P;_a=fG;_b=hY();if(_b!==C){_c=hX();if(_c!==C){_d=[];E=iA();while (E!==C) {_d.push(E);E=iA()}if(_d!==C){E=gZ();E==C&&(E=null);if(E!==C){F=hW();if(F!==C){G=hA();G==C&&(G=null);if(G!==C){H=hW();if(H!==C){_.charCodeAt(fG)==123?(I=o,fG++):(I=C,!fL&&fW(p));if(I!==C){J=hW();if(J!==C){K=gC();if(K==C){K=gF();K==C&&(K=gJ(),K==C&&(K=gR(),K==C&&(K=gQ(),K==C&&(K=gP()))))}if(K!==C){L=hW();if(L!==C){_.charCodeAt(fG)==125?(M=q,fG++):(M=C,!fL&&fW(r));M!==C?(N=hW(),N!==C?(O=hZ(),O==C&&(O=hA()),O==C&&(O=null),O!==C?(P=hB(),P!==C?(fH=_a,_b=s(E,G,K,O),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}return _a}function gC(){var _a,_b,_c,_d,E;fL++;_a=fG;_b=gD();_b!==C?(_c=hW(),_c!==C?(_d=hV(),_d==C&&(_d=null),_d!==C?(E=hW(),E!==C?(fH=_a,_b=u(_b,_d),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(t));return _a}function gD(){var _a,_b,_c;fL++;_a=fG;_b=[];_c=gE();if(_c!==C)while (_c!==C) {_b.push(_c);_c=gE()}else _b=C;_b!==C&&(fH=_a,_b=w(_b));_a=_b;fL--;_a==C&&(_b=C,!fL&&fW(v));return _a}function gE(){var _a,_b,_c,_d,E,F,G,H,I,J;fL++;_a=fG;_b=hW();if(_b!==C){_.charCodeAt(fG)==61?(_c=y,fG++):(_c=C,!fL&&fW(z));if(_c!==C){_d=hW();if(_d!==C){E=hN();E==C&&(E=null);if(E!==C){F=hW();if(F!==C){_.substr(fG,2)==aA?(G=aA,fG+=2):(G=C,!fL&&fW(aB));G!==C?(H=hW(),H!==C?(I=hP(),I!==C?(J=hW(),J!==C?(fH=_a,_b=aC(E,I),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(x));return _a}function gF(){var _a,_b,_c,_d,E,F;fL++;_a=fG;_b=gG();if(_b!==C){_c=hW();_c!==C?(_d=fG,E=gO(),E==C&&(E=null),E!==C?(F=gO(),F==C&&(F=null),F!==C?(E=[E,F],_d=E):(fG=_d,_d=C)):(fG=_d,_d=C),_d!==C?(E=hW(),E!==C?(F=hV(),F==C&&(F=null),F!==C?(fH=_a,_b=aE(_b,_d,F),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(aD));return _a}function gG(){var _a,_b;_a=fG;_b=gH();_b==C&&(_b=gI());_b!==C&&(fH=_a,_b=aF(_b));_a=_b;return _a}function gH(){var _a,_b;_a=fG;_.substr(fG,4)==aG?(_b=aG,fG+=4):(_b=C,!fL&&fW(aH));_b==C&&_.charCodeAt(fG)==84?(_b=aI,fG++):(_b=C,!fL&&fW(aJ));_b!==C&&(fH=_a,_b=aK());_a=_b;return _a}function gI(){var _a,_b;_a=fG;_.substr(fG,5)==aL?(_b=aL,fG+=5):(_b=C,!fL&&fW(aM));_b==C&&_.charCodeAt(fG)==70?(_b=aN,fG++):(_b=C,!fL&&fW(aO));_b!==C&&(fH=_a,_b=aP());_a=_b;return _a}function gJ(){var _a,_b,_c,_d,E;fL++;_a=fG;_b=gK();_b!==C?(_c=hW(),_c!==C?(_d=hV(),_d==C&&(_d=null),_d!==C?(E=hW(),E!==C?(fH=_a,_b=aR(_b,_d),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(aQ));return _a}function gK(){var _a,_b,_c;fL++;_a=fG;_b=[];_c=gL();if(_c!==C)while (_c!==C) {_b.push(_c);_c=gL()}else _b=C;_b!==C&&(fH=_a,_b=aT(_b));_a=_b;fL--;_a==C&&(_b=C,!fL&&fW(aS));return _a}function gL(){var _a,_b,_c,_d,E,F,G,H;fL++;_a=fG;_b=hW();if(_b!==C){_c=fG;aV.test(_.charAt(fG))?(_d=_.charAt(fG),fG++):(_d=C,!fL&&fW(aW));if(_d!==C){E=hW();E!==C?(F=gM(),F==C&&(F=null),F!==C?(G=hW(),G!==C?(H=hO(),H!==C?(_d=[_d,E,F,G,H],_c=_d):(fG=_c,_c=C)):(fG=_c,_c=C)):(fG=_c,_c=C)):(fG=_c,_c=C)}else{fG=_c;_c=C}_c!==C?(_d=gO(),_d==C&&(_d=null),_d!==C?(E=hW(),E!==C?(fH=_a,_b=aX(_c,_d),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(aU));return _a}function gM(){var _a,_b,_c,_d;fL++;_a=fG;_.charCodeAt(fG)==37?(_b=aZ,fG++):(_b=C,!fL&&fW(bA));_b!==C?(_c=gN(),_c!==C?(_.charCodeAt(fG)==37?(_d=aZ,fG++):(_d=C,!fL&&fW(bA)),_d!==C?(fH=_a,_b=bB(_c),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(aY));return _a}function gN(){var _a,_b,_c,_d,E;fL++;_a=fG;_b=[];_c=fG;_d=fG;fL++;_.charCodeAt(fG)==37?(E=aZ,fG++):(E=C,!fL&&fW(bA));fL--;E==C?_d=void 0:fG=_d;_d!==C?(_.length>fG?(E=_.charAt(fG),fG++):(E=C,!fL&&fW(bD)),E!==C?(_d=[_d,E],_c=_d):(fG=_c,_c=C)):(fG=_c,_c=C);while (_c!==C) {_b.push(_c);_c=fG;_d=fG;fL++;_.charCodeAt(fG)==37?(E=aZ,fG++):(E=C,!fL&&fW(bA));fL--;E==C?_d=void 0:fG=_d;_d!==C?(_.length>fG?(E=_.charAt(fG),fG++):(E=C,!fL&&fW(bD)),E!==C?(_d=[_d,E],_c=_d):(fG=_c,_c=C)):(fG=_c,_c=C)}_b!==C&&(fH=_a,_b=bE(_b));_a=_b;fL--;_a==C&&(_b=C,!fL&&fW(bC));return _a}function gO(){var _a,_b,_c,_d,E;fL++;_a=fG;_.charCodeAt(fG)==35?(_b=bG,fG++):(_b=C,!fL&&fW(bH));_b!==C?(_c=fG,fL++,_.substr(fG,3)==bI?(_d=bI,fG+=3):(_d=C,!fL&&fW(bJ)),fL--,_d==C?_c=void 0:fG=_c,_c!==C?(_d=hW(),_d!==C?(E=hO(),E==C&&(E=null),E!==C?(fH=_a,_b=bK(E),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(bF));return _a}function gP(){var _a,_b,_c,_d,E;fL++;_a=fG;_b=bM;_b!==C?(_c=hW(),_c!==C?(_d=hV(),_d==C&&(_d=null),_d!==C?(E=hW(),E!==C?(fH=_a,_b=bN(_d),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(bL));return _a}function gQ(){var _a,_b,_c,_d,E,F,G;fL++;_a=fG;_b=hO();if(_b!==C){_c=hW();if(_c!==C){_d=gO();_d==C&&(_d=null);_d!==C?(E=hW(),E!==C?(F=hV(),F==C&&(F=null),F!==C?(G=hW(),G!==C?(fH=_a,_b=bP(_b,_d,F),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(bO));return _a}function gR(){var _a,_b,_c,_d,E,F;fL++;_a=fG;_.charCodeAt(fG)==35?(_b=bG,fG++):(_b=C,!fL&&fW(bH));if(_b!==C){_c=hW();_c!==C?(_d=gS(),_d!==C?(E=hW(),E!==C?(F=hV(),F==C&&(F=null),F!==C?(fH=_a,_b=bR(_d,F),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(bQ));return _a}function gS(){var _a;fL++;_a=gT();_a==C&&(_a=gV());fL--;_a==C&&!fL&&fW(bS);return _a}function gT(){var _a,_b,_c;fL++;_a=fG;_b=[];_c=gU();if(_c!==C)while (_c!==C) {_b.push(_c);_c=gU()}else _b=C;_b!==C&&(fH=_a,_b=aT(_b));_a=_b;fL--;_a==C&&(_b=C,!fL&&fW(bT));return _a}function gU(){var _a,_b,_c,_d,E,F;fL++;_a=fG;_b=hW();if(_b!==C){_c=fG;aV.test(_.charAt(fG))?(_d=_.charAt(fG),fG++):(_d=C,!fL&&fW(aW));_d!==C?(E=gM(),E==C&&(E=null),E!==C?(F=gV(),F==C&&(F=null),F!==C?(_d=[_d,E,F],_c=_d):(fG=_c,_c=C)):(fG=_c,_c=C)):(fG=_c,_c=C);_c!==C?(_d=hW(),_d!==C?(E=gO(),E==C&&(E=null),E!==C?(F=hW(),F!==C?(fH=_a,_b=bV(_c,E),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(bU));return _a}function gV(){var _a;fL++;_a=gW();_a==C&&(_a=gX(),_a==C&&(_a=gY()));fL--;_a==C&&!fL&&fW(bW);return _a}function gW(){var _a,_b,_c,_d;fL++;_a=fG;_b=hR();_b!==C?(_.charCodeAt(fG)==58?(_c=bY,fG++):(_c=C,!fL&&fW(bZ)),_c!==C?(_d=hR(),_d!==C?(fH=_a,_b=cA(_b,_d),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(bX));return _a}function gX(){var _a,_b,_c,_d;fL++;_a=fG;_b=hR();_b!==C?(_.substr(fG,2)==cC?(_c=cC,fG+=2):(_c=C,!fL&&fW(cD)),_c!==C?(_d=hR(),_d!==C?(fH=_a,_b=cE(_b,_d),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(cB));return _a}function gY(){var _a,_b;fL++;_a=fG;_b=hR();_b!==C&&(fH=_a,_b=cG(_b));_a=_b;fL--;_a==C&&(_b=C,!fL&&fW(cF));return _a}function gZ(){var _a,_b,_c,_d;fL++;_a=fG;_.substr(fG,2)==cI?(_b=cI,fG+=2):(_b=C,!fL&&fW(cJ));if(_b!==C){_c=[];_d=hE();if(_d!==C)while (_d!==C) {_c.push(_d);_d=hE()}else _c=C;_c!==C?(_.substr(fG,2)==cI?(_d=cI,fG+=2):(_d=C,!fL&&fW(cJ)),_d!==C?(fH=_a,_b=cK(_c),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(cH));return _a}function hA(){var _a,_b;fL++;_a=fG;_b=hO();_b!==C&&(fH=_a,_b=cM(_b));_a=_b;fL--;_a==C&&(_b=C,!fL&&fW(cL));return _a}function hB(){var _a,_b,_c;fL++;_a=hC();_a==C&&(_a=fG,_b=iC(),_b==C&&(_b=null),_b!==C?(_c=iD(),_c!==C?(_b=[_b,_c],_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C));fL--;_a==C&&(_b=C,!fL&&fW(cN));return _a}function hC(){var _a,_b,_c,_d;fL++;_a=fG;_b=iC();if(_b!==C){_c=[];_d=hD();if(_d!==C)while (_d!==C) {_c.push(_d);_d=hD()}else _c=C;_c!==C?(_b=[_b,_c],_a=_b):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(cO));return _a}function hD(){var _a,_b,_c;fL++;_a=fG;_b=[];_c=iB();while (_c!==C) {_b.push(_c);_c=iB()}_b!==C?(_c=iC(),_c!==C?(_b=[_b,_c],_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(cP));return _a}function hE(){var _a,_b,_c;fL++;_a=fG;_b=fG;fL++;_.substr(fG,2)==cI?(_c=cI,fG+=2):(_c=C,!fL&&fW(cJ));fL--;_c==C?_b=void 0:fG=_b;_b!==C?(_c=hJ(),_c==C&&(_c=hK()),_c!==C?(fH=_a,_b=cR(_c),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(cQ));return _a}function hF(){var _a;fL++;_a=hK();_a==C&&(_a=hJ(),_a==C&&(_a=hI()));fL--;_a==C&&!fL&&fW(cS);return _a}function hG(){var _a;fL++;_a=hL();_a==C&&(_a=hJ(),_a==C&&(_a=hI()));fL--;_a==C&&!fL&&fW(cS);return _a}function hH(){var _a,_b,_c,_d;fL++;_a=fG;_.charCodeAt(fG)==91?(_b=cU,fG++):(_b=C,!fL&&fW(cV));if(_b!==C){_.substr(fG,4)==cW?(_c=cW,fG+=4):(_c=C,!fL&&fW(cX));if(_c==C){_.substr(fG,8)==cY?(_c=cY,fG+=8):(_c=C,!fL&&fW(cZ));_c==C&&(_.substr(fG,5)==dA?(_c=dA,fG+=5):(_c=C,!fL&&fW(dB)),_c==C&&_.substr(fG,6)==dC?(_c=dC,fG+=6):(_c=C,!fL&&fW(dD)))}_c!==C?(_.charCodeAt(fG)==93?(_d=dE,fG++):(_d=C,!fL&&fW(dF)),_d!==C?(fH=_a,_b=dG(_c),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(cT));return _a}function hI(){var _a;fL++;_.charCodeAt(fG)==92?(_a=dI,fG++):(_a=C,!fL&&fW(dJ));fL--;_a==C&&!fL&&fW(dH);return _a}function hJ(){var _a,_b,_c;fL++;_a=fG;_.charCodeAt(fG)==92?(_b=dI,fG++):(_b=C,!fL&&fW(dJ));if(_b!==C){_.charCodeAt(fG)==92?(_c=dI,fG++):(_c=C,!fL&&fW(dJ));if(_c==C){_.charCodeAt(fG)==58?(_c=bY,fG++):(_c=C,!fL&&fW(bZ));if(_c==C){_.charCodeAt(fG)==35?(_c=bG,fG++):(_c=C,!fL&&fW(bH));if(_c==C){_.charCodeAt(fG)==61?(_c=y,fG++):(_c=C,!fL&&fW(z));if(_c==C){_.charCodeAt(fG)==123?(_c=o,fG++):(_c=C,!fL&&fW(p));if(_c==C){_.charCodeAt(fG)==125?(_c=q,fG++):(_c=C,!fL&&fW(r));_c==C&&(_.charCodeAt(fG)==126?(_c=dL,fG++):(_c=C,!fL&&fW(dM)),_c==C&&_.charCodeAt(fG)==110?(_c=dN,fG++):(_c=C,!fL&&fW(dO)))}}}}}_c!==C?(fH=_a,_b=dP(_c),_a=_b):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(dK));return _a}function hK(){var _a,_b,_c;fL++;_a=fG;_b=fG;fL++;_c=hJ();_c==C&&(_c=hM(),_c==C&&(_c=hB()));fL--;_c==C?_b=void 0:fG=_b;_b!==C?(_.length>fG?(_c=_.charAt(fG),fG++):(_c=C,!fL&&fW(bD)),_c!==C?(fH=_a,_b=dR(),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(dQ));return _a}function hL(){var _a,_b,_c;fL++;_a=fG;_b=fG;fL++;_c=hJ();_c==C&&(_c=hM(),_c==C&&(_.substr(fG,2)==aA?(_c=aA,fG+=2):(_c=C,!fL&&fW(aB)),_c==C&&(_c=hB())));fL--;_c==C?_b=void 0:fG=_b;_b!==C?(_.length>fG?(_c=_.charAt(fG),fG++):(_c=C,!fL&&fW(bD)),_c!==C?(fH=_a,_b=dR(),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(dQ));return _a}function hM(){var _a;_.charCodeAt(fG)==61?(_a=y,fG++):(_a=C,!fL&&fW(z));if(_a==C){_.charCodeAt(fG)==126?(_a=dL,fG++):(_a=C,!fL&&fW(dM));if(_a==C){_.charCodeAt(fG)==35?(_a=bG,fG++):(_a=C,!fL&&fW(bH));if(_a==C){_.charCodeAt(fG)==123?(_a=o,fG++):(_a=C,!fL&&fW(p));if(_a==C){_.charCodeAt(fG)==125?(_a=q,fG++):(_a=C,!fL&&fW(r));_a==C&&(_.charCodeAt(fG)==92?(_a=dI,fG++):(_a=C,!fL&&fW(dJ)),_a==C&&_.charCodeAt(fG)==58?(_a=bY,fG++):(_a=C,!fL&&fW(bZ)))}}}}return _a}function hN(){var _a,_b,_c,_d,E;fL++;_a=fG;_b=hH();_b==C&&(_b=null);if(_b!==C){_c=hW();if(_c!==C){_d=[];E=hG();if(E!==C)while (E!==C) {_d.push(E);E=hG()}else _d=C;_d!==C?(fH=_a,_b=dT(_b,_d),_a=_b):(fG=_a,_a=C)}else{fG=_a;_a=C}}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(dS));return _a}function hO(){var _a,_b,_c,_d,E;fL++;_a=fG;_b=hH();_b==C&&(_b=null);if(_b!==C){_c=hW();if(_c!==C){_d=[];E=hF();if(E!==C)while (E!==C) {_d.push(E);E=hF()}else _d=C;_d!==C?(fH=_a,_b=dT(_b,_d),_a=_b):(fG=_a,_a=C)}else{fG=_a;_a=C}}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(dU));return _a}function hP(){var _a,_b,_c;fL++;_a=fG;_b=[];_c=hF();if(_c!==C)while (_c!==C) {_b.push(_c);_c=hF()}else _b=C;_b!==C&&(fH=_a,_b=dW(_b));_a=_b;fL--;_a==C&&(_b=C,!fL&&fW(dV));return _a}function hQ(){var _a,_b,_c,_d,E;fL++;_a=fG;_b=[];_c=fG;_d=fG;fL++;E=iC();fL--;E==C?_d=void 0:fG=_d;_d!==C?(_.length>fG?(E=_.charAt(fG),fG++):(E=C,!fL&&fW(bD)),E!==C?(_d=[_d,E],_c=_d):(fG=_c,_c=C)):(fG=_c,_c=C);while (_c!==C) {_b.push(_c);_c=fG;_d=fG;fL++;E=iC();fL--;E==C?_d=void 0:fG=_d;_d!==C?(_.length>fG?(E=_.charAt(fG),fG++):(E=C,!fL&&fW(bD)),E!==C?(_d=[_d,E],_c=_d):(fG=_c,_c=C)):(fG=_c,_c=C)}_b!==C?(_c=fG,fL++,_d=iC(),_d==C&&(_d=iD()),fL--,_d!==C?(fG=_c,_c=void 0):(_c=C),_c!==C?(fH=_a,_b=dY(_b),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C);fL--;_a==C&&(_b=C,!fL&&fW(dX));return _a}function hR(){var _a,_b,_c;_a=fG;_b=hU();_b==C&&(_b=null);_b!==C?(_c=hS(),_c!==C?(fH=_a,_b=dZ(),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C);return _a}function hS(){var _a,_b,_c,_d,E;_a=fG;_b=hT();_b!==C?(_c=fG,_.charCodeAt(fG)==46?(_d=eA,fG++):(_d=C,!fL&&fW(eB)),_d!==C?(E=hT(),E!==C?(_d=[_d,E],_c=_d):(fG=_c,_c=C)):(fG=_c,_c=C),_c==C&&(_c=null),_c!==C?(_b=[_b,_c],_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C);return _a}function hT(){var _a,_b;_a=[];eC.test(_.charAt(fG))?(_b=_.charAt(fG),fG++):(_b=C,!fL&&fW(eD));if(_b!==C)while (_b!==C) {_a.push(_b);eC.test(_.charAt(fG))?(_b=_.charAt(fG),fG++):(_b=C,!fL&&fW(eD))}else _a=C;return _a}function hU(){var _a;eE.test(_.charAt(fG))?(_a=_.charAt(fG),fG++):(_a=C,!fL&&fW(eF));return _a}function hV(){var _a,_b,_c,_d,E;_a=fG;_.substr(fG,4)==eG?(_b=eG,fG+=4):(_b=C,!fL&&fW(eH));_b!==C?(_c=hW(),_c!==C?(_d=hO(),_d!==C?(E=hW(),E!==C?(fH=_a,_b=eI(_d),_a=_b):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C)):(fG=_a,_a=C);return _a}function hW(){var _a,_b,_c,_d,E;fL++;_a=[];_b=iB();_b==C&&(_b=fG,_c=iC(),_c!==C?(_d=fG,fL++,E=hD(),fL--,E==C?_d=void 0:fG=_d,_d!==C?(_c=[_c,_d],_b=_c):(fG=_b,_b=C)):(fG=_b,_b=C));while (_b!==C) {_a.push(_b);_b=iB();_b==C&&(_b=fG,_c=iC(),_c!==C?(_d=fG,fL++,E=hD(),fL--,E==C?_d=void 0:fG=_d,_d!==C?(_c=[_c,_d],_b=_c):(fG=_b,_b=C)):(fG=_b,_b=C))}fL--;_a==C&&(_b=C,!fL&&fW(eJ));return _a}function hX(){var _a,_b;fL++;_a=[];_b=iA();_b==C&&(_b=iC(),_b==C&&(_b=iB()));while (_b!==C) {_a.push(_b);_b=iA();_b==C&&(_b=iC(),_b==C&&(_b=iB()))}fL--;_a==C&&(_b=C,!fL&&fW(eK));return _a}function hY(){var _a,_b,_c,_d;_a=fG;_b=fG;fL++;_c=[];_.charCodeAt(fG)==32?(_d=eL,fG++):(_d=C,!fL&&fW(eM));while (_d!==C) {_c.push(_d);_.charCodeAt(fG)==32?(_d=eL,fG++):(_d=C,!fL&&fW(eM))}fL--;_c!==C?(fG=_b,_b=void 0):(_b=C);_b!==C&&(fH=_a,_b=eN());_a=_b;return _a}function hZ(){var _a,_b,_c,_d;fL++;_a=fG;_.substr(fG,2)==eP?(_b=eP,fG+=2):(_b=C,!fL&&fW(eQ));if(_b!==C){_c=[];eR.test(_.charAt(fG))?(_d=_.charAt(fG),fG++):(_d=C,!fL&&fW(eS));while (_d!==C) {_c.push(_d);eR.test(_.charAt(fG))?(_d=_.charAt(fG),fG++):(_d=C,!fL&&fW(eS))}_c!==C?(fH=_a,_b=eT(_c),_a=_b):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(eO));return _a}function iA(){var _a,_b,_c,_d;fL++;_a=fG;_.substr(fG,2)==eP?(_b=eP,fG+=2):(_b=C,!fL&&fW(eQ));if(_b!==C){_c=[];eR.test(_.charAt(fG))?(_d=_.charAt(fG),fG++):(_d=C,!fL&&fW(eS));while (_d!==C) {_c.push(_d);eR.test(_.charAt(fG))?(_d=_.charAt(fG),fG++):(_d=C,!fL&&fW(eS))}_c!==C?(fH=_a,_b=eU(_c),_a=_b):(fG=_a,_a=C)}else{fG=_a;_a=C}fL--;_a==C&&(_b=C,!fL&&fW(eO));return _a}function iB(){var _a;fL++;_.charCodeAt(fG)==32?(_a=eL,fG++):(_a=C,!fL&&fW(eM));_a==C&&_.charCodeAt(fG)==9?(_a=eW,fG++):(_a=C,!fL&&fW(eX));fL--;_a==C&&!fL&&fW(eV);return _a}function iC(){var _a;fL++;_.substr(fG,2)==eZ?(_a=eZ,fG+=2):(_a=C,!fL&&fW(fA));_a==C&&(_.charCodeAt(fG)==10?(_a=fB,fG++):(_a=C,!fL&&fW(fC)),_a==C&&_.charCodeAt(fG)==13?(_a=fD,fG++):(_a=C,!fL&&fW(fE)));fL--;_a==C&&!fL&&fW(eY);return _a}function iD(){var _a,_b,_c;_a=fG;_b=fG;fL++;_.length>fG?(_c=_.charAt(fG),fG++):(_c=C,!fL&&fW(bD));fL--;_c==C?_b=void 0:fG=_b;_b!==C&&(fH=_a,_b=fF());_a=_b;return _a}var iE=null,iF=null,iG="moodle",iH=iG,iI={"\\\\":"&&092;","\\:":"&&058;","\\#":"&&035;","\\=":"&&061;","\\{":"&&123;","\\}":"&&125;","\\~":"&&126;","\\n":"&&010"};function iJ(_a){return _a.replaceAll('&&092;','\\').replaceAll('&&058;',':').replaceAll('&&035;','#').replaceAll('&&061;','=').replaceAll('&&123;','{').replaceAll('&&125;','}').replaceAll('&&126;','~').replaceAll('&&010','\n')}function iK(_a,_b){_a.globalFeedback=_b.globalFeedback;switch(_a.type) {case "TF":_a.isTrue=_b.isTrue;_a.trueFeedback=_b.feedback[0];_a.falseFeedback=_b.feedback[1];break;case "MC":case "Numerical":case "Short":_a.choices=_b.choices;break;case "Matching":_a.matchPairs=_b.matchPairs;break}_a.type=="MC"&&iL(_a.choices)&&(_a.type="Short");_a.id=iE;_a.tags=iF;return _a}function iL(_a){var _b=!0;for(var i=0;i<_a.length;i++)_b&=_a[i].isCorrect;return _b}function iM(_a){_a=_a.replace(/[\n\r]/g,' ');return _a.replace(/\s\s+/g,' ')}function iN(_a){iH=_a}function iO(){return iH}function iP(){iH=iG}function iQ(_a,_b){let _c=(_a!==null?_a:iO());let _d=_b.join('').replace(/\r\n/g,'\n').trim();return{format:(_c),text:(((_c=="html")||(_c=="markdown"))?iJ(_d):iJ(iM(_d)))}}fM=fY();if(fM!==C&&fG==_.length)return fM;fM!==C&&fG<_.length&&fW(fS());throw fX(fK,fJ<_.length?_.charAt(fJ):null,fJ<_.length?fV(fJ,fJ+1):fV(fJ,fJ))}A.giftParser={SyntaxError:c,parse:d}})(this);
